import Shadow



def create_bragg_file():
    tmp=""" 5   8095683980.2420149       3.34799999999999994E-008
6          -1   1.0000000000000000
(  3.9999999999999698     , 3.49691120014913805E-007)
(  3.9999999999999698     ,-3.49691120014913805E-007)
(  0.0000000000000000     ,  0.0000000000000000     )
(  0.0000000000000000     , -0.0000000000000000     )
6.4895292907500366       -15.047842788024230        3.5219264986085363
0.0000000000000000        0.0000000000000000        0.0000000000000000
181
2000.0000000000000       0.16810214303309934       0.17257472131615312
1.0000000000000000        0.0000000000000000
2100.0000000000000       0.15793396422744266       0.15701669842268562
1.0000000000000000        0.0000000000000000
2200.0000000000000       0.14866135442595496       0.14335354167434439
1.0000000000000000        0.0000000000000000
2300.0000000000000       0.14002610290197559       0.13137186825540964
1.0000000000000000        0.0000000000000000
2400.0000000000000       0.13215791145122502       0.12081612649379145
1.0000000000000000        0.0000000000000000
2500.0000000000000       0.12492073189573727       0.11146196051531869
1.0000000000000000        0.0000000000000000
2600.0000000000000       0.11827734770669096       0.10312296700904702
1.0000000000000000        0.0000000000000000
2700.0000000000000       0.11212132625659699       9.56607045914864285E-002
1.0000000000000000        0.0000000000000000
2800.0000000000000       0.10652368474645613       8.89577476911316833E-002
1.0000000000000000        0.0000000000000000
2900.0000000000000       0.10129080687840464       8.29084447734958069E-002
1.0000000000000000        0.0000000000000000
3000.0000000000000       9.63802186687638951E-002  7.74589669293338640E-002
1.0000000000000000        0.0000000000000000
3100.0000000000000       9.18623921756696049E-002  7.25138632215356488E-002
1.0000000000000000        0.0000000000000000
3200.0000000000000       8.76117311538928689E-002  6.79964310926789994E-002
1.0000000000000000        0.0000000000000000
3300.0000000000000       8.37146986570598273E-002  6.38874660072098061E-002
1.0000000000000000        0.0000000000000000
3400.0000000000000       8.00436604417296138E-002  6.01235559733363373E-002
1.0000000000000000        0.0000000000000000
3500.0000000000000       7.65997383715912861E-002  5.66676384015727952E-002
1.0000000000000000        0.0000000000000000
3600.0000000000000       7.33779401368233053E-002  5.34917749046520397E-002
1.0000000000000000        0.0000000000000000
3700.0000000000000       7.03310764182134562E-002  5.05672169646800423E-002
1.0000000000000000        0.0000000000000000
3800.0000000000000       6.75377217734576263E-002  4.78526977969900777E-002
1.0000000000000000        0.0000000000000000
3900.0000000000000       6.48589468303102379E-002  4.53613727291847929E-002
1.0000000000000000        0.0000000000000000
4000.0000000000000       6.23114546575154193E-002  4.30481312400741375E-002
1.0000000000000000        0.0000000000000000
4100.0000000000000       5.98855808312226401E-002  4.08922819157812728E-002
1.0000000000000000        0.0000000000000000
4200.0000000000000       5.76628790097384325E-002  3.88939366228271688E-002
1.0000000000000000        0.0000000000000000
4300.0000000000000       5.55572033009426036E-002  3.70323629535279780E-002
1.0000000000000000        0.0000000000000000
4400.0000000000000       5.35399345060616483E-002  3.52933927869278213E-002
1.0000000000000000        0.0000000000000000
4500.0000000000000       5.16059585933872356E-002  3.36663440242008991E-002
1.0000000000000000        0.0000000000000000
4600.0000000000000       4.97648249914339758E-002  3.21429246635385329E-002
1.0000000000000000        0.0000000000000000
4700.0000000000000       4.80872473755811214E-002  3.07165575252285085E-002
1.0000000000000000        0.0000000000000000
4800.0000000000000       4.64574052854889175E-002  2.93856205452803117E-002
1.0000000000000000        0.0000000000000000
4900.0000000000000       4.48770968600031850E-002  2.81337980672401004E-002
1.0000000000000000        0.0000000000000000
5000.0000000000000       4.34168217528014821E-002  2.69569504792379275E-002
1.0000000000000000        0.0000000000000000
5100.0000000000000       4.20077009070887186E-002  2.58493424287771500E-002
1.0000000000000000        0.0000000000000000
5200.0000000000000       4.07038386279054976E-002  2.48039657312627594E-002
1.0000000000000000        0.0000000000000000
5300.0000000000000       3.94250608261668134E-002  2.38185960560945119E-002
1.0000000000000000        0.0000000000000000
5400.0000000000000       3.81699377266491169E-002  2.28874500742224166E-002
1.0000000000000000        0.0000000000000000
5500.0000000000000       3.69498565886905439E-002  2.20058631137908974E-002
1.0000000000000000        0.0000000000000000
5600.0000000000000       3.58384234718824857E-002  2.11726028787606949E-002
1.0000000000000000        0.0000000000000000
5700.0000000000000       3.48326423097740090E-002  2.03835665761555943E-002
1.0000000000000000        0.0000000000000000
5800.0000000000000       3.37586285884476922E-002  1.96386688425194793E-002
1.0000000000000000        0.0000000000000000
5900.0000000000000       3.27750221659890428E-002  1.89306567007331283E-002
1.0000000000000000        0.0000000000000000
6000.0000000000000       3.18210226364366022E-002  1.82587706840696487E-002
1.0000000000000000        0.0000000000000000
6100.0000000000000       3.09292299472234689E-002  1.76195037785723888E-002
1.0000000000000000        0.0000000000000000
6200.0000000000000       3.00889656146354767E-002  1.70102248154527756E-002
1.0000000000000000        0.0000000000000000
6300.0000000000000       2.92618027784126156E-002  1.64292442639501768E-002
1.0000000000000000        0.0000000000000000
6400.0000000000000       2.84478551393503309E-002  1.58765342865163604E-002
1.0000000000000000        0.0000000000000000
6500.0000000000000       2.76485972834743521E-002  1.53533349229178096E-002
1.0000000000000000        0.0000000000000000
6600.0000000000000       2.69147989858202763E-002  1.48528867026440775E-002
1.0000000000000000        0.0000000000000000
6700.0000000000000       2.62155988597427836E-002  1.43736734305488275E-002
1.0000000000000000        0.0000000000000000
6800.0000000000000       2.55256311448510687E-002  1.39142552846806475E-002
1.0000000000000000        0.0000000000000000
6900.0000000000000       2.48477795557686676E-002  1.34788237041714200E-002
1.0000000000000000        0.0000000000000000
7000.0000000000000       2.42377024810691566E-002  1.30626421221922348E-002
1.0000000000000000        0.0000000000000000
7100.0000000000000       2.36202346435883115E-002  1.26623471952680006E-002
1.0000000000000000        0.0000000000000000
7200.0000000000000       2.29719117927569272E-002  1.22771326556526707E-002
1.0000000000000000        0.0000000000000000
7300.0000000000000       2.24034985049259561E-002  1.19124805013500392E-002
1.0000000000000000        0.0000000000000000
7400.0000000000000       2.18867022112299026E-002  1.15621675049613522E-002
1.0000000000000000        0.0000000000000000
7500.0000000000000       2.13863807225500580E-002  1.12237683960455803E-002
1.0000000000000000        0.0000000000000000
7600.0000000000000       2.08392375637096450E-002  1.09003236009121516E-002
1.0000000000000000        0.0000000000000000
7700.0000000000000       2.03499794006347656E-002  1.05914999730885029E-002
1.0000000000000000        0.0000000000000000
7800.0000000000000       1.98660116412288090E-002  1.02920658118610467E-002
1.0000000000000000        0.0000000000000000
7900.0000000000000       1.93396541684425216E-002  1.00055116808664447E-002
1.0000000000000000        0.0000000000000000
8000.0000000000000       1.89156027605328347E-002  9.73137705001849047E-003
1.0000000000000000        0.0000000000000000
8100.0000000000000       1.85182276356590236E-002  9.46465142044448232E-003
1.0000000000000000        0.0000000000000000
8200.0000000000000       1.80752326632536153E-002  9.21081469300568528E-003
1.0000000000000000        0.0000000000000000
8300.0000000000000       1.76373729483474406E-002  8.96596026113096606E-003
1.0000000000000000        0.0000000000000000
8400.0000000000000       1.72028742334218165E-002  8.72698469613257533E-003
1.0000000000000000        0.0000000000000000
8500.0000000000000       1.68372111676688974E-002  8.50199574716303287E-003
1.0000000000000000        0.0000000000000000
8600.0000000000000       1.64743650584160406E-002  8.28173473411866583E-003
1.0000000000000000        0.0000000000000000
8700.0000000000000       1.61158811713413286E-002  8.07004945602116108E-003
1.0000000000000000        0.0000000000000000
8800.0000000000000       1.57622333888518540E-002  7.86677174816107980E-003
1.0000000000000000        0.0000000000000000
8900.0000000000000       1.54109016841781354E-002  7.66752054274283824E-003
1.0000000000000000        0.0000000000000000
9000.0000000000000       1.50661001076670686E-002  7.47959717921272121E-003
1.0000000000000000        0.0000000000000000
9100.0000000000000       1.47358169797886518E-002  7.29456706570145129E-003
1.0000000000000000        0.0000000000000000
9200.0000000000000       1.44539834742776208E-002  7.11809788268267379E-003
1.0000000000000000        0.0000000000000000
9300.0000000000000       1.41496412180002196E-002  6.94641834912522200E-003
1.0000000000000000        0.0000000000000000
9400.0000000000000       1.38181385803139989E-002  6.78051828807260844E-003
1.0000000000000000        0.0000000000000000
9500.0000000000000       1.35254970931724117E-002  6.62092219560756791E-003
1.0000000000000000        0.0000000000000000
9600.0000000000000       1.32543704502641191E-002  6.46481619286731236E-003
1.0000000000000000        0.0000000000000000
9700.0000000000000       1.29875996262702742E-002  6.31594265011650377E-003
1.0000000000000000        0.0000000000000000
9800.0000000000000       1.27219262777762410E-002  6.16889137036773054E-003
1.0000000000000000        0.0000000000000000
9900.0000000000000       1.25086243180057011E-002  6.01189129492938571E-003
1.0000000000000000        0.0000000000000000
10000.000000000000       1.23000144958496094E-002  5.85399987176060677E-003
1.0000000000000000        0.0000000000000000
10100.000000000000       1.06460968952246660E-002  5.60754886697774173E-003
1.0000000000000000        0.0000000000000000
10200.000000000000       9.05525309093935249E-003  5.36702955562354169E-003
1.0000000000000000        0.0000000000000000
10300.000000000000       8.81246870972418606E-003  5.25328674553050302E-003
1.0000000000000000        0.0000000000000000
10400.000000000000       8.57022260927386981E-003  5.13989403115309215E-003
1.0000000000000000        0.0000000000000000
10500.000000000000       8.33795128363146176E-003  5.03298887150449396E-003
1.0000000000000000        0.0000000000000000
10600.000000000000       8.10586330598983551E-003  4.92620459440141524E-003
1.0000000000000000        0.0000000000000000
10700.000000000000       7.88334514151234345E-003  4.82572975821321266E-003
1.0000000000000000        0.0000000000000000
10800.000000000000       7.66082697703485138E-003  4.72525492202501007E-003
1.0000000000000000        0.0000000000000000
10900.000000000000       7.44726132839801380E-003  4.63050419712746075E-003
1.0000000000000000        0.0000000000000000
11000.000000000000       7.23420069726543602E-003  4.53607637323821897E-003
1.0000000000000000        0.0000000000000000
11100.000000000000       7.02860701824548073E-003  4.44638848815941644E-003
1.0000000000000000        0.0000000000000000
11200.000000000000       6.82450067850570719E-003  4.35764474964438295E-003
1.0000000000000000        0.0000000000000000
11300.000000000000       6.62601368926729606E-003  4.27253335628964906E-003
1.0000000000000000        0.0000000000000000
11400.000000000000       6.43017228721021183E-003  4.18913206907470161E-003
1.0000000000000000        0.0000000000000000
11500.000000000000       6.23810301688720870E-003  4.10816009300180029E-003
1.0000000000000000        0.0000000000000000
11600.000000000000       6.05006009031949787E-003  4.02978114454329711E-003
1.0000000000000000        0.0000000000000000
11700.000000000000       5.86397062344534703E-003  3.95255767438249667E-003
1.0000000000000000        0.0000000000000000
11800.000000000000       5.68391405343149358E-003  3.87890268399021651E-003
1.0000000000000000        0.0000000000000000
11900.000000000000       5.50385748341675196E-003  3.80524769359793721E-003
1.0000000000000000        0.0000000000000000
12000.000000000000       5.33087045818625427E-003  3.73586155823994607E-003
1.0000000000000000        0.0000000000000000
12100.000000000000       5.15816423933923573E-003  3.66664498425891584E-003
1.0000000000000000        0.0000000000000000
12200.000000000000       4.98947025304463665E-003  3.60007513130689277E-003
1.0000000000000000        0.0000000000000000
12300.000000000000       4.82308951475829417E-003  3.53503124228352842E-003
1.0000000000000000        0.0000000000000000
12400.000000000000       4.65836833845045817E-003  3.47101244937534671E-003
1.0000000000000000        0.0000000000000000
12500.000000000000       4.49833880346250936E-003  3.40989164000196892E-003
1.0000000000000000        0.0000000000000000
12600.000000000000       4.33830926847456055E-003  3.34877083062859156E-003
1.0000000000000000        0.0000000000000000
12700.000000000000       4.18361853662130301E-003  3.29075430069150892E-003
1.0000000000000000        0.0000000000000000
12800.000000000000       4.02993115292105131E-003  3.23332117361832408E-003
1.0000000000000000        0.0000000000000000
12900.000000000000       3.87841809688183048E-003  3.17718852634139631E-003
1.0000000000000000        0.0000000000000000
13000.000000000000       3.73052590194955513E-003  3.12322154010987547E-003
1.0000000000000000        0.0000000000000000
13100.000000000000       3.58263370701639161E-003  3.06925455387835420E-003
1.0000000000000000        0.0000000000000000
13200.000000000000       3.43910781759326767E-003  3.01808963422230819E-003
1.0000000000000000        0.0000000000000000
13300.000000000000       3.29629093549588248E-003  2.96737971839578906E-003
1.0000000000000000        0.0000000000000000
13400.000000000000       3.15514703973907018E-003  2.91757678908723854E-003
1.0000000000000000        0.0000000000000000
13500.000000000000       3.01798016263266078E-003  2.86992994570028220E-003
1.0000000000000000        0.0000000000000000
13600.000000000000       2.88081328552713956E-003  2.82228310231332543E-003
1.0000000000000000        0.0000000000000000
13700.000000000000       2.74654109590066753E-003  2.77659866640431099E-003
1.0000000000000000        0.0000000000000000
13800.000000000000       2.61361922427827409E-003  2.73182965717521991E-003
1.0000000000000000        0.0000000000000000
13900.000000000000       2.48077705763005696E-003  2.68710530823644284E-003
1.0000000000000000        0.0000000000000000
14000.000000000000       2.35268464714621928E-003  2.64504234263347130E-003
1.0000000000000000        0.0000000000000000
14100.000000000000       2.22459223666326977E-003  2.60297937703050019E-003
1.0000000000000000        0.0000000000000000
14200.000000000000       2.09779870144544134E-003  2.56167649122885374E-003
1.0000000000000000        0.0000000000000000
14300.000000000000       1.97405029864317072E-003  2.52215556532983621E-003
1.0000000000000000        0.0000000000000000
14400.000000000000       1.85030189584090010E-003  2.48263463943081868E-003
1.0000000000000000        0.0000000000000000
14500.000000000000       1.72870467544061768E-003  2.44437659644823916E-003
1.0000000000000000        0.0000000000000000
14600.000000000000       1.60902665731565975E-003  2.40724524907472669E-003
1.0000000000000000        0.0000000000000000
14700.000000000000       1.48934863919070182E-003  2.37011390170121378E-003
1.0000000000000000        0.0000000000000000
14800.000000000000       1.37232754592098161E-003  2.33456301137288918E-003
1.0000000000000000        0.0000000000000000
14900.000000000000       1.25642569547501637E-003  2.29967789644434104E-003
1.0000000000000000        0.0000000000000000
15000.000000000000       1.14052384502993931E-003  2.26479278151579290E-003
1.0000000000000000        0.0000000000000000
15100.000000000000       1.02726129697394697E-003  2.23164625064909989E-003
1.0000000000000000        0.0000000000000000
15200.000000000000       9.14563645429744554E-004  2.19887183329051843E-003
1.0000000000000000        0.0000000000000000
15300.000000000000       8.01865993884653960E-004  2.16609741593193697E-003
1.0000000000000000        0.0000000000000000
15400.000000000000       6.92213103300254318E-004  2.13508358535955886E-003
1.0000000000000000        0.0000000000000000
15500.000000000000       5.82946923495697433E-004  2.10429336442302444E-003
1.0000000000000000        0.0000000000000000
15600.000000000000       4.73680743691140549E-004  2.07350314348649046E-003
1.0000000000000000        0.0000000000000000
15700.000000000000       3.67126843926257607E-004  2.04437844308390715E-003
1.0000000000000000        0.0000000000000000
15800.000000000000       2.60895880514588896E-004  2.01545204710422291E-003
1.0000000000000000        0.0000000000000000
15900.000000000000       1.54664917103808364E-004  1.98652565112453867E-003
1.0000000000000000        0.0000000000000000
16000.000000000000       5.10507261264336876E-005  1.95907336968221017E-003
1.0000000000000000        0.0000000000000000
16100.000000000000      -5.20698413746245592E-005  1.93189916268469877E-003
1.0000000000000000        0.0000000000000000
16200.000000000000      -1.55190408875682806E-004  1.90472495568718737E-003
1.0000000000000000        0.0000000000000000
16300.000000000000      -2.56433866313798831E-004  1.87875153220976878E-003
1.0000000000000000        0.0000000000000000
16400.000000000000      -3.56980571060816487E-004  1.85322382002288291E-003
1.0000000000000000        0.0000000000000000
16500.000000000000      -4.57527275806945966E-004  1.82769610783599682E-003
1.0000000000000000        0.0000000000000000
16600.000000000000      -5.56669605638937526E-004  1.80302958700353263E-003
1.0000000000000000        0.0000000000000000
16700.000000000000      -6.54693186109334135E-004  1.77904910610818994E-003
1.0000000000000000        0.0000000000000000
16800.000000000000      -7.52716766578842567E-004  1.75506862521284724E-003
1.0000000000000000        0.0000000000000000
16900.000000000000      -8.49903489349657093E-004  1.73155572122389795E-003
1.0000000000000000        0.0000000000000000
17000.000000000000      -9.45325702919497246E-004  1.70902870020393284E-003
1.0000000000000000        0.0000000000000000
17100.000000000000      -1.04074791648844922E-003  1.68650167918396750E-003
1.0000000000000000        0.0000000000000000
17200.000000000000      -1.13613036042270465E-003  1.66400689836184671E-003
1.0000000000000000        0.0000000000000000
17300.000000000000      -1.22986697352978069E-003  1.64284634930349986E-003
1.0000000000000000        0.0000000000000000
17400.000000000000      -1.32360358663685673E-003  1.62168580024515279E-003
1.0000000000000000        0.0000000000000000
17500.000000000000      -1.41734019974393277E-003  1.60052525118680594E-003
1.0000000000000000        0.0000000000000000
17600.000000000000      -1.50960984742276594E-003  1.58021351891929123E-003
1.0000000000000000        0.0000000000000000
17700.000000000000      -1.60112746295659747E-003  1.56033692813589741E-003
1.0000000000000000        0.0000000000000000
17800.000000000000      -1.69264507848954082E-003  1.54046033735250336E-003
1.0000000000000000        0.0000000000000000
17900.000000000000      -1.78372338178167666E-003  1.52086433935685016E-003
1.0000000000000000        0.0000000000000000
18000.000000000000      -1.87335306825975323E-003  1.50219358630489176E-003
1.0000000000000000        0.0000000000000000
18100.000000000000      -1.96298275473782979E-003  1.48352283325293359E-003
1.0000000000000000        0.0000000000000000
18200.000000000000      -2.05261244121679454E-003  1.46485208020097520E-003
1.0000000000000000        0.0000000000000000
18300.000000000000      -2.14107190438550532E-003  1.44701722472684660E-003
1.0000000000000000        0.0000000000000000
18400.000000000000      -2.22911463725594672E-003  1.42948004222143523E-003
1.0000000000000000        0.0000000000000000
18500.000000000000      -2.31715737012638812E-003  1.41194285971602386E-003
1.0000000000000000        0.0000000000000000
18600.000000000000      -2.40493000042274474E-003  1.39459066293350651E-003
1.0000000000000000        0.0000000000000000
18700.000000000000      -2.49141766169191925E-003  1.37811850561781520E-003
1.0000000000000000        0.0000000000000000
18800.000000000000      -2.57790532296020558E-003  1.36164634830212390E-003
1.0000000000000000        0.0000000000000000
18900.000000000000      -2.66439298422938009E-003  1.34517419098643238E-003
1.0000000000000000        0.0000000000000000
19000.000000000000      -2.75005323932830947E-003  1.32924276200794048E-003
1.0000000000000000        0.0000000000000000
19100.000000000000      -2.83500977453510217E-003  1.31377122963314175E-003
1.0000000000000000        0.0000000000000000
19200.000000000000      -2.91996630974189486E-003  1.29829969725834301E-003
1.0000000000000000        0.0000000000000000
19300.000000000000      -3.00492284494868755E-003  1.28282816488354428E-003
1.0000000000000000        0.0000000000000000
19400.000000000000      -3.08883267644155524E-003  1.26814250825773764E-003
1.0000000000000000        0.0000000000000000
19500.000000000000      -3.17253716786236595E-003  1.25361102303730640E-003
1.0000000000000000        0.0000000000000000
19600.000000000000      -3.25624165928317666E-003  1.23907953781687537E-003
1.0000000000000000        0.0000000000000000
19700.000000000000      -3.33988060196954706E-003  1.22460025870921351E-003
1.0000000000000000        0.0000000000000000
19800.000000000000      -3.42247600706713229E-003  1.21095210229704166E-003
1.0000000000000000        0.0000000000000000
19900.000000000000      -3.50507141216560569E-003  1.19730394588487003E-003
1.0000000000000000        0.0000000000000000
20000.000000000000      -3.58766681726319092E-003  1.18365578947269819E-003
1.0000000000000000        0.0000000000000000     """

    file_out = "HOPG2_20.002"
    f = open(file_out,'w')
    f.write(tmp)
    f.close
    print("File written to disk: %s"%file_out)

def run_example_crystal_mosaic(user_units_to_cm=1.0,iwrite=0):
    #
    # Python script to run shadow3. Created automatically with ShadowTools.make_python_script_from_list().
    #


    #
    # initialize shadow3 source (oe0) and beam
    #
    beam = Shadow.Beam()
    oe0 = Shadow.Source()
    oe1 = Shadow.OE()

    #
    # Define variables. See meaning of variables in:
    #  https://raw.githubusercontent.com/srio/shadow3/master/docs/source.nml
    #  https://raw.githubusercontent.com/srio/shadow3/master/docs/oe.nml
    #

    oe0.FSOUR = 0
    oe0.F_COLOR = 2
    oe0.F_PHOT = 0
    oe0.HDIV1 = 0.0005
    oe0.HDIV2 = 0.0005
    oe0.N_COLOR = 3
    oe0.PH1 = 7996.0
    oe0.PH2 = 8000.0
    oe0.PH3 = 8004.0
    oe0.VDIV1 = 0.0001
    oe0.VDIV2 = 0.0001
    oe0.WYSOU = 0.0
    oe0.ISTAR1 = 1234567
    oe0.NPOINT = 10000


    oe1.DUMMY = user_units_to_cm
    oe1.T_IMAGE = 1000.0  / user_units_to_cm
    oe1.T_SOURCE = 1000.0 / user_units_to_cm
    oe1.THICKNESS = 0.1    / user_units_to_cm


    oe1.FILE_REFL = b'HOPG2_20.002'
    oe1.F_CENTRAL = 1
    oe1.F_CRYSTAL = 1
    oe1.F_MOSAIC = 1
    oe1.PHOT_CENT = 8000.0
    oe1.R_LAMBDA = 5000.0
    oe1.SPREAD_MOS = 0.2
    oe1.T_INCIDENCE = 76.617
    oe1.T_REFLECTION = 76.617




    #Run SHADOW to create the source

    if iwrite:
        oe0.write("start.00")

    beam.genSource(oe0)

    if iwrite:
        oe0.write("end.00")
        beam.write("begin.dat")


    #
    #run optical element 1
    #
    print("    Running optical element: %d"%(1))
    if iwrite:
        oe1.write("start.01")
    beam.traceOE(oe1,1)
    if iwrite:
        oe1.write("end.01")
        beam.write("star.01")

    print(oe1.mirinfo())

    return beam



def test_mosaic(plot=0):

    cm_or_mm = 0  # 0=using cm, 1=using mm

    create_bragg_file()

    if cm_or_mm == 0:
        beam = run_example_crystal_mosaic(user_units_to_cm=1.0)
        title = "Using units: cm"
    else:
        beam = run_example_crystal_mosaic(user_units_to_cm=0.1)
        title = "Using units: mm"

    if plot:
        Shadow.ShadowTools.plotxy(beam,1,3,nbins=101,nolost=1,title=title)

if __name__ == "__main__":


    test_mosaic(plot=1)